{% extends "base.html" %}
{% block head %}

{# /plugin/플러그인 모듈이름/static/css/admin.css #}
{% endblock %}

{% block title %}
출석판
{% endblock title %}
{% block subtitle %}
출석판
{% endblock subtitle %}

{% block content %}

<form name="ftodo" action="{{ action_url }}" onsubmit="return frm_form_check(this);" method="post">
    <input type="hidden" name="action" value="{{ 'update' if request.path_params.id else '' }}">
    <input type="hidden" name="token" value="">


    <div class="tbl_frm01 tbl_wrap">
        <table>
            <caption>목록</caption>
            <colgroup>
                <col class="grid_4">
                <col>
            </colgroup>
            <tbody>
            <tr>
                <th scope="row"><label for="title">제목</label></th>
                <td>
                    <input type="text" name="title" value="{{ attendance_config.title|default_if_none('') }}"
                           id="title" required
                           class="frm_input required" size="90">
                </td>
            </tr>
            <tr>
                <th scope="row">포인트</th>
                <td>
                    <input type="text" name="point" value="{{ attendance_config.point|default_if_none(0) }}">
                </td>
            </tr>

            <tr>
                <th scope="row">시작 시간</th>
                <td>
                    <input type="datetime-local" name="start_date" value="{{ attendance_config.start_date }}">
                </td>
            </tr>
            <tr>
                <th scope="row">종료 시간</th>
                <td>
                    <input type="datetime-local" name="end_date" value="{{ attendance_config.end_date }}">
                </td>
            </tr>
            {% if request.path_params.id %} {# 수정 #}
            <tr>
                <th scope="row">등록 시간</th>
                <td>
                    {{ attendance_config.created_at }}
                </td>
            </tr>
            {% endif %}
            </tbody>
        </table>
    </div>

    <div class="btn_fixed_top">
        <a href="/admin/attendance" class="btn btn_02">목록</a>
        <input type="submit" value="확인" class="btn btn_submit" accesskey="s">
    </div>

</form>

<script>
    function frm_form_check(f) {
        error_msg = "";
        error_field = "";

        check_field(f.title, "제목을 입력하세요.");
        try {
            start_date = new Date(f.start_date.value);
            
            end_date = new Date(f.end_date.value);
        } catch (e) {
            error_msg += "\n" + e.message;
        }
console.log(Intl.DateTimeFormat().resolvedOptions().timeZone)
        if (error_msg != "") {
            alert(error_msg);
            error_field.focus();
            return false;
        }

        f.token.value = generate_token();

        return true;
    }
</script>

{% endblock %}